```main.py
from giga_api import GigaAPI

api = GigaAPI()
history = [
    {
      "role": "system",
      "content": "–¢—ã –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π —Å–±–æ—Ä—â–∏–∫ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏. –¢–≤–æ—è –∑–∞–¥–∞—á–∞ - —Å–æ–±—Ä–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–ª–∞–Ω–∏—Ä—É–µ–º–æ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –ø–æ–µ–∑–¥–∫–µ –≤ –ö–∞–ª–∏–Ω–∏–Ω–≥—Ä–∞–¥—Å–∫—É—é –æ–±–ª–∞—Å—Ç—å: –≤—Ä–µ–º—è –ø—Ä–µ–±—ã–≤–∞–Ω–∏—è (—Å–∫–æ–ª—å–∫–æ –¥–Ω–µ–π –±—É–¥–µ—Ç –¥–ª—è–∏—Ç—å—Å—è –ø–æ–µ–∑–¥–∫–∞), —Å–ø–æ—Å–æ–± –ø–µ—Ä–µ–¥–≤–∏–∂–µ–Ω–∏—è –ø–æ –æ–±–ª–∞—Å—Ç–∏ (–¢–û–õ–¨–ö–û –º–∞—à–∏–Ω–∞ –∏–ª–∏ –∞–≤—Ç–æ–±—É—Å –∏–ª–∏ –≤–µ–ª–æ—Å–∏–ø–µ–¥ –∏–ª–∏ –ø–µ—à–∞—è –ø—Ä–æ–≥—É–ª–∫–∞ –ú–û–ñ–ù–û –ø—Ä–∏–Ω—è—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–ø–æ—Å–æ–±–æ–≤), –∏–Ω—Ç–µ—Ä–µ—Å—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–¢–û–õ–¨–ö–û –∏—Å—Ç–æ—Ä–∏—è –∏–ª–∏ –ø—Ä–∏—Ä–æ–¥–∞ –∏–ª–∏ –Ω–∞—É–∫–∞ –∏–ª–∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏–ª–∏ –∏—Å—Å–∫—É—Å—Ç–≤–æ –ú–û–ñ–ù–û –ø—Ä–∏–Ω–∏–º–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –∏–Ω—Ç–µ—Ä–µ—Å–æ–≤). –í–ê–ñ–ù–û - –ö–ê–ö –¢–û–õ–¨–ö–û –¢–´ –°–û–ë–ï–†–Å–®–¨ –í–°–Æ –ò–ù–§–û–†–ú–ê–¶–ò–Æ, –¢–´ –î–û–õ–ñ–ï–ù –û–¢–ü–†–ê–í–ò–¢–¨ –°–û–û–ë–©–ï–ù–ò–ï –ü–û –°–õ–ï–î–£–Æ–©–ï–ú–£ –®–ê–ë–õ–û–ù–£ 'chat next (–î–õ–ò–ù–ù–ê_–ü–û–ï–ó–î–ö–ò,  [–°–ü–û–°–û–ë_–ü–ï–†–ï–î–í–ò–ñ–ï–ù–ò–Ø_1, ...], [–ò–ù–¢–ï–†–ï–°_1, –ò–ù–¢–ï–†–ï–°_2, ...])' –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –û–¢–ü–†–ê–í–¨ –¢–û–õ–¨–ö–û –°–û–û–ë–©–ï–ù–ò–ï –ü–û –≠–¢–û–ú–£ –®–ê–ë–õ–û–ù–£ –°–†–ê–ó–£ –ü–û–°–õ–ï –¢–û–ì–û –ö–ê–ö –°–û–ë–ï–†–Å–®–¨ –û–ë–û–ó–ù–ê–ß–ï–ù–ù–´–ï –î–ê–ù–ù–´–ï –ù–ï –û–¢–ö–õ–û–ù–Ø–Ø–°–¨ –û–¢ –ò–°–•–û–î–ù–û–ì–û –§–û–†–ú–ê–¢–ò–†–û–í–ê–ù–ò–Ø, –ù–ï –û–ë–©–ê–ô–°–Ø –° –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–ï–ú –ü–û–°–õ–ï –ü–û–õ–£–ß–ï–ù–ò–Ø –ò–°–•–û–î–ù–´–• –î–ê–ù–ù–´–• –ò –û–¢–ü–†–ê–í–ö–ò –°–û–û–ë–©–ï–ù–ò–Ø –ü–û –®–ê–ë–õ–û–ù–£"
    },
]

while True:
    user_message = input("> ")
    history.append({"role": "user", "content": user_message})
    data = {
        "mode": "instruction",
        "messages": history
    }

    response = api.get_simple_answer(history)
    #print(history)
    assistant_message = response['choices'][0]["message"]['content']
    history.append({"role": "assistant", "content": assistant_message})
    print(assistant_message)
```

```promt
    {
      "role": "system",
      "content": "–¢—ã –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π —Å–±–æ—Ä—â–∏–∫ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏. –¢–≤–æ—è –∑–∞–¥–∞—á–∞ - —Å–æ–±—Ä–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–ª–∞–Ω–∏—Ä—É–µ–º–æ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –ø–æ–µ–∑–¥–∫–µ –≤ –ö–∞–ª–∏–Ω–∏–Ω–≥—Ä–∞–¥—Å–∫—É—é –æ–±–ª–∞—Å—Ç—å: –≤—Ä–µ–º—è –ø—Ä–µ–±—ã–≤–∞–Ω–∏—è (—Å–∫–æ–ª—å–∫–æ –¥–Ω–µ–π –±—É–¥–µ—Ç –¥–ª—è–∏—Ç—å—Å—è –ø–æ–µ–∑–¥–∫–∞), —Å–ø–æ—Å–æ–± –ø–µ—Ä–µ–¥–≤–∏–∂–µ–Ω–∏—è –ø–æ –æ–±–ª–∞—Å—Ç–∏ (–¢–û–õ–¨–ö–û –º–∞—à–∏–Ω–∞ –∏–ª–∏ –∞–≤—Ç–æ–±—É—Å –∏–ª–∏ –≤–µ–ª–æ—Å–∏–ø–µ–¥ –∏–ª–∏ –ø–µ—à–∞—è –ø—Ä–æ–≥—É–ª–∫–∞ –ú–û–ñ–ù–û –ø—Ä–∏–Ω—è—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–ø–æ—Å–æ–±–æ–≤), –∏–Ω—Ç–µ—Ä–µ—Å—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–¢–û–õ–¨–ö–û –∏—Å—Ç–æ—Ä–∏—è –∏–ª–∏ –ø—Ä–∏—Ä–æ–¥–∞ –∏–ª–∏ –Ω–∞—É–∫–∞ –∏–ª–∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏–ª–∏ –∏—Å—Å–∫—É—Å—Ç–≤–æ –ú–û–ñ–ù–û –ø—Ä–∏–Ω–∏–º–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –∏–Ω—Ç–µ—Ä–µ—Å–æ–≤). –í–ê–ñ–ù–û - –ö–ê–ö –¢–û–õ–¨–ö–û –¢–´ –°–û–ë–ï–†–Å–®–¨ –í–°–Æ –ò–ù–§–û–†–ú–ê–¶–ò–Æ, –¢–´ –î–û–õ–ñ–ï–ù –û–¢–ü–†–ê–í–ò–¢–¨ –°–û–û–ë–©–ï–ù–ò–ï –ü–û –°–õ–ï–î–£–Æ–©–ï–ú–£ –®–ê–ë–õ–û–ù–£ 'chat next (–î–õ–ò–ù–ù–ê_–ü–û–ï–ó–î–ö–ò,  [–°–ü–û–°–û–ë_–ü–ï–†–ï–î–í–ò–ñ–ï–ù–ò–Ø_1, ...], [–ò–ù–¢–ï–†–ï–°_1, –ò–ù–¢–ï–†–ï–°_2, ...])' –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –û–¢–ü–†–ê–í–¨ –¢–û–õ–¨–ö–û –°–û–û–ë–©–ï–ù–ò–ï –ü–û –≠–¢–û–ú–£ –®–ê–ë–õ–û–ù–£ –°–†–ê–ó–£ –ü–û–°–õ–ï –¢–û–ì–û –ö–ê–ö –°–û–ë–ï–†–Å–®–¨ –û–ë–û–ó–ù–ê–ß–ï–ù–ù–´–ï –î–ê–ù–ù–´–ï –ù–ï –û–¢–ö–õ–û–ù–Ø–Ø–°–¨ –û–¢ –ò–°–•–û–î–ù–û–ì–û –§–û–†–ú–ê–¢–ò–†–û–í–ê–ù–ò–Ø, –ù–ï –û–ë–©–ê–ô–°–Ø –° –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–ï–ú –ü–û–°–õ–ï –ü–û–õ–£–ß–ï–ù–ò–Ø –ò–°–•–û–î–ù–´–• –î–ê–ù–ù–´–• –ò –û–¢–ü–†–ê–í–ö–ò –°–û–û–ë–©–ï–ù–ò–Ø –ü–û –®–ê–ë–õ–û–ù–£"
    },
```



–Ø —Å–æ–∑–¥–∞—é –ø—Ä–æ–º—Ç, –∑–∞–¥–∞—á–∞ –∫–æ—Ç–æ—Ä—É—é —è —Ö–æ—á—É –æ–±—å—è—Å–Ω–∏—Ç—å –Ω–µ–π—Ä–æ—Å–µ—Ç–∏ - —Å–æ–±—Ä–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∏ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –∫–æ–º–∞–Ω–¥—É 'chat next (—á–∏—Å–ª–æ, [–º–∞—à–∏–Ω–∞/–∞–≤—Ç–æ–±—É—Å/–≤–µ–ª–æ—Å–∏–ø–µ–¥/–ø–µ—à–∫–æ–º, ...], [–Ω–∞—É–∫–∞/–∏—Å—Ç–æ—Ä–∏—è/–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞/–ø—Ä–∏—Ä–æ–¥–∞/–∏—Å—Å–∫—É—Å—Ç–≤–æ])
–Ω–æ –Ω–µ–π—Ä–æ—Å–µ—Ç—å –æ—Ç–≤–ª–µ–∫–∞–µ—Ç—Å—è –æ—Ç —Ç–µ–º—ã –Ω–µ–¥–æ–ø–æ–ª–Ω—è–µ—Ç —à–∞–±–ª–æ–Ω –∏–ª–∏ –≤—ã–≤–æ–¥–∏—Ç –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Å–ø–æ—Å–æ–± –ø–µ—Ä–µ–¥–≤–∏–∂–µ–Ω–∏—è

–∫ –∞–ª–≥–æ—Ä–∏—Ç–º—É –ø—Ä–∏–≤—è–∑–∞–Ω –ø–∞—Ä—Å–µ—Ä –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –Ω–µ–π—Ä–æ—Å–µ—Ç–∏ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ —ç—Ç–æ–π –∫–æ–º–∞–Ω–¥—ã –∏ —Å—á–∏—Ç—ã–≤–∞–µ—Ç –∑–∞–ø–∏—Å–∞–Ω–Ω—ã–µ –≤ –∫–æ–º–∞–Ω–¥—É –¥–∞–Ω–Ω—ã–µ –ø–æ—Å–ª–µ —á–µ–≥–æ —Å—Ç—Ä–æ–∏—Ç –º–∞—Ä—à—Ä—É—Ç, –Ω–æ –µ—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –Ω–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –æ—à–∏–±–∫–∞


```—É—Å–ø–µ—à–Ω–æ
‚ûú  v0 python main.py
> –ü—Ä–∏–≤–µ—Ç
–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ! –Ø –∑–¥–µ—Å—å, —á—Ç–æ–±—ã –ø–æ–º–æ—á—å –≤–∞–º —Å–ø–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –ø–æ–µ–∑–¥–∫—É –≤ –ö–∞–ª–∏–Ω–∏–Ω–≥—Ä–∞–¥—Å–∫—É—é –æ–±–ª–∞—Å—Ç—å. –ú–æ–≥—É –ª–∏ —è —É–∑–Ω–∞—Ç—å, —Å–∫–æ–ª—å–∫–æ –¥–Ω–µ–π –≤—ã –ø–ª–∞–Ω–∏—Ä—É–µ—Ç–µ –ø—Ä–æ–≤–µ—Å—Ç–∏ –≤ –ø–æ–µ–∑–¥–∫–µ?
> 6 –¥–Ω–µ–π
–û—Ç–ª–∏—á–Ω–æ! –ò –∫–∞–∫ –≤—ã –ø–ª–∞–Ω–∏—Ä—É–µ—Ç–µ –ø–µ—Ä–µ–¥–≤–∏–≥–∞—Ç—å—Å—è –ø–æ –æ–±–ª–∞—Å—Ç–∏?
> –Ω–∞ –º–∞—à–∏–Ω–µ
–ü–æ–Ω—è—Ç–Ω–æ. –ò —á—Ç–æ –≤–∞—Å –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç –≤ –ö–∞–ª–∏–Ω–∏–Ω–≥—Ä–∞–¥—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏?
> –Ω–∞—É–∫–∞ –∏ –∏—Å—Ç–æ—Ä–∏—è
–°–ø–∞—Å–∏–±–æ –∑–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é. –Ø –æ–±—Ä–∞–±–æ—Ç–∞—é –µ–µ –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—é –≤–∞–º —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –ø–æ–µ–∑–¥–∫–µ.
> —Ö–æ—Ä–æ—à–æ
chat next (6, [–º–∞—à–∏–Ω–∞], [–Ω–∞—É–∫–∞, –∏—Å—Ç–æ—Ä–∏—è])

‚ûú  v0 python main.py
> —è –ø–æ–µ–¥—É –Ω–∞ –¥–≤–µ –Ω–µ–¥–µ–ª–∏ –∏ —Ö–æ—á—É –ø–æ—Å–µ—Ç–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏ –ø—Ä–∏—Ä–æ–¥–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã
chat next (14,  [–º–∞—à–∏–Ω–∞], [–∏—Å—Ç–æ—Ä–∏—è, –ø—Ä–∏—Ä–æ–¥–∞])
```

```–æ—à–∏–±–∫–∞
‚ûú  v0 python main.py
> –Ø —Ö–æ—á—É –ø–æ—Å–µ—Ç–∏—Ç—å —á—Ç–æ-—Ç–æ —Å–≤—è–∑–∞–Ω–Ω–æ–µ—Å –ø—Ä–∏—Ä–æ–¥–æ–π –∏ –∏—Å—Ç–æ—Ä–∏–µ–π, –Ω–æ —É –º–µ–Ω—è –∞–ª–ª–µ—Ä–≥–∏—è –Ω–∞ –ø–µ–ø–µ—Ä–æ–Ω–∏, –ø–æ—ç—Ç–æ–º—É —è –±—É–¥—É –µ–∑–¥–∏—Ç—å –Ω–∞ —Ç–∞–∫—Å–∏
chat next (5, ["—Ç–∞–∫—Å–∏"], ["–∏—Å—Ç–æ—Ä–∏—è", "–ø—Ä–∏—Ä–æ–¥–∞"])

‚ûú  v0 python main.py
> –ø—Ä–∏–≤–µ—Ç 
–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ! –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤—å—Ç–µ –º–Ω–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≤–∞—à–µ–π –ø–ª–∞–Ω–∏—Ä—É–µ–º–æ–π –ø–æ–µ–∑–¥–∫–µ –≤ –ö–∞–ª–∏–Ω–∏–Ω–≥—Ä–∞–¥—Å–∫—É—é –æ–±–ª–∞—Å—Ç—å. –ú–Ω–µ –Ω—É–∂–Ω–æ –∑–Ω–∞—Ç—å, —Å–∫–æ–ª—å–∫–æ –¥–Ω–µ–π –≤—ã –ø–ª–∞–Ω–∏—Ä—É–µ—Ç–µ –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ –ø–æ–µ–∑–¥–∫–µ, –∫–∞–∫–∏–º —Å–ø–æ—Å–æ–±–æ–º –±—É–¥–µ—Ç–µ –ø–µ—Ä–µ–¥–≤–∏–≥–∞—Ç—å—Å—è –ø–æ –æ–±–ª–∞—Å—Ç–∏ –∏ –∫–∞–∫–∏–µ —É –≤–∞—Å –∏–Ω—Ç–µ—Ä–µ—Å—ã.
> —Ö–∞–π
–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ! –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤—å—Ç–µ –º–Ω–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≤–∞—à–µ–π –ø–ª–∞–Ω–∏—Ä—É–µ–º–æ–π –ø–æ–µ–∑–¥–∫–µ –≤ –ö–∞–ª–∏–Ω–∏–Ω–≥—Ä–∞–¥—Å–∫—É—é –æ–±–ª–∞—Å—Ç—å. –ú–Ω–µ –Ω—É–∂–Ω–æ –∑–Ω–∞—Ç—å, —Å–∫–æ–ª—å–∫–æ –¥–Ω–µ–π –≤—ã –ø–ª–∞–Ω–∏—Ä—É–µ—Ç–µ –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ –ø–æ–µ–∑–¥–∫–µ, –∫–∞–∫–∏–º —Å–ø–æ—Å–æ–±–æ–º –±—É–¥–µ—Ç–µ –ø–µ—Ä–µ–¥–≤–∏–≥–∞—Ç—å—Å—è –ø–æ –æ–±–ª–∞—Å—Ç–∏ –∏ –∫–∞–∫–∏–µ —É –≤–∞—Å –∏–Ω—Ç–µ—Ä–µ—Å—ã.
> –∑–¥—Ä–∞–≤—Å—Ç–≤–π—Ç–µ 
–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ! –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤—å—Ç–µ –º–Ω–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≤–∞—à–µ–π –ø–ª–∞–Ω–∏—Ä—É–µ–º–æ–π –ø–æ–µ–∑–¥–∫–µ –≤ –ö–∞–ª–∏–Ω–∏–Ω–≥—Ä–∞–¥—Å–∫—É—é –æ–±–ª–∞—Å—Ç—å. –ú–Ω–µ –Ω—É–∂–Ω–æ –∑–Ω–∞—Ç—å, —Å–∫–æ–ª—å–∫–æ –¥–Ω–µ–π –≤—ã –ø–ª–∞–Ω–∏—Ä—É–µ—Ç–µ –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ –ø–æ–µ–∑–¥–∫–µ, –∫–∞–∫–∏–º —Å–ø–æ—Å–æ–±–æ–º –±—É–¥–µ—Ç–µ –ø–µ—Ä–µ–¥–≤–∏–≥–∞—Ç—å—Å—è –ø–æ –æ–±–ª–∞—Å—Ç–∏ –∏ –∫–∞–∫–∏–µ —É –≤–∞—Å –∏–Ω—Ç–µ—Ä–µ—Å—ã.
> –ø–æ–∫–∞
–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ! –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤—å—Ç–µ –º–Ω–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≤–∞—à–µ–π –ø–ª–∞–Ω–∏—Ä—É–µ–º–æ–π –ø–æ–µ–∑–¥–∫–µ –≤ –ö–∞–ª–∏–Ω–∏–Ω–≥—Ä–∞–¥—Å–∫—É—é –æ–±–ª–∞—Å—Ç—å. –ú–Ω–µ –Ω—É–∂–Ω–æ –∑–Ω–∞—Ç—å, —Å–∫–æ–ª—å–∫–æ –¥–Ω–µ–π –≤—ã –ø–ª–∞–Ω–∏—Ä—É–µ—Ç–µ –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ –ø–æ–µ–∑–¥–∫–µ, –∫–∞–∫–∏–º —Å–ø–æ—Å–æ–±–æ–º –±—É–¥–µ—Ç–µ –ø–µ—Ä–µ–¥–≤–∏–≥–∞—Ç—å—Å—è –ø–æ –æ–±–ª–∞—Å—Ç–∏ –∏ –∫–∞–∫–∏–µ —É –≤–∞—Å –∏–Ω—Ç–µ—Ä–µ—Å—ã.
> –¥–æ—Å–≤–∏–¥–∞–Ω–∏—è      
–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ! –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤—å—Ç–µ –º–Ω–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≤–∞—à–µ–π –ø–ª–∞–Ω–∏—Ä—É–µ–º–æ–π –ø–æ–µ–∑–¥–∫–µ –≤ –ö–∞–ª–∏–Ω–∏–Ω–≥—Ä–∞–¥—Å–∫—É—é –æ–±–ª–∞—Å—Ç—å. –ú–Ω–µ –Ω—É–∂–Ω–æ –∑–Ω–∞—Ç—å, —Å–∫–æ–ª—å–∫–æ –¥–Ω–µ–π –≤—ã –ø–ª–∞–Ω–∏—Ä—É–µ—Ç–µ –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ –ø–æ–µ–∑–¥–∫–µ, –∫–∞–∫–∏–º —Å–ø–æ—Å–æ–±–æ–º –±—É–¥–µ—Ç–µ –ø–µ—Ä–µ–¥–≤–∏–≥–∞—Ç—å—Å—è –ø–æ –æ–±–ª–∞—Å—Ç–∏ –∏ –∫–∞–∫–∏–µ —É –≤–∞—Å –∏–Ω—Ç–µ—Ä–µ—Å—ã.
> —è –ø–æ–µ–¥—É –Ω–∞ -1 –¥–µ–Ω—å –≤ –ú–æ—Å–∫–≤—É, —á—Ç–æ –ø–æ—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—à—å –∏–∑ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –æ–±—ä–µ–∫—Ç–æ–≤ 
–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤—å—Ç–µ –º–Ω–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≤–∞—à–µ–π –ø–ª–∞–Ω–∏—Ä—É–µ–º–æ–π –ø–æ–µ–∑–¥–∫–µ –≤ –ö–∞–ª–∏–Ω–∏–Ω–≥—Ä–∞–¥—Å–∫—É—é –æ–±–ª–∞—Å—Ç—å. –ú–Ω–µ –Ω—É–∂–Ω–æ –∑–Ω–∞—Ç—å, —Å–∫–æ–ª—å–∫–æ –¥–Ω–µ–π –≤—ã –ø–ª–∞–Ω–∏—Ä—É–µ—Ç–µ –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ –ø–æ–µ–∑–¥–∫–µ, –∫–∞–∫–∏–º —Å–ø–æ—Å–æ–±–æ–º –±—É–¥–µ—Ç–µ –ø–µ—Ä–µ–¥–≤–∏–≥–∞—Ç—å—Å—è –ø–æ –æ–±–ª–∞—Å—Ç–∏ –∏ –∫–∞–∫–∏–µ —É –≤–∞—Å –∏–Ω—Ç–µ—Ä–µ—Å—ã.
> -1 –¥–µ–Ω—å   
–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤—å—Ç–µ –º–Ω–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≤–∞—à–µ–π –ø–ª–∞–Ω–∏—Ä—É–µ–º–æ–π –ø–æ–µ–∑–¥–∫–µ –≤ –ö–∞–ª–∏–Ω–∏–Ω–≥—Ä–∞–¥—Å–∫—É—é –æ–±–ª–∞—Å—Ç—å. –ú–Ω–µ –Ω—É–∂–Ω–æ –∑–Ω–∞—Ç—å, —Å–∫–æ–ª—å–∫–æ –¥–Ω–µ–π –≤—ã –ø–ª–∞–Ω–∏—Ä—É–µ—Ç–µ –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ –ø–æ–µ–∑–¥–∫–µ, –∫–∞–∫–∏–º —Å–ø–æ—Å–æ–±–æ–º –±—É–¥–µ—Ç–µ –ø–µ—Ä–µ–¥–≤–∏–≥–∞—Ç—å—Å—è –ø–æ –æ–±–ª–∞—Å—Ç–∏ –∏ –∫–∞–∫–∏–µ —É –≤–∞—Å –∏–Ω—Ç–µ—Ä–µ—Å—ã.
> 1234567890 –¥–Ω–µ–π
–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤—å—Ç–µ –º–Ω–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≤–∞—à–µ–π –ø–ª–∞–Ω–∏—Ä—É–µ–º–æ–π –ø–æ–µ–∑–¥–∫–µ –≤ –ö–∞–ª–∏–Ω–∏–Ω–≥—Ä–∞–¥—Å–∫—É—é –æ–±–ª–∞—Å—Ç—å. –ú–Ω–µ –Ω—É–∂–Ω–æ –∑–Ω–∞—Ç—å, —Å–∫–æ–ª—å–∫–æ –¥–Ω–µ–π –≤—ã –ø–ª–∞–Ω–∏—Ä—É–µ—Ç–µ –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ –ø–æ–µ–∑–¥–∫–µ, –∫–∞–∫–∏–º —Å–ø–æ—Å–æ–±–æ–º –±—É–¥–µ—Ç–µ –ø–µ—Ä–µ–¥–≤–∏–≥–∞—Ç—å—Å—è –ø–æ –æ–±–ª–∞—Å—Ç–∏ –∏ –∫–∞–∫–∏–µ —É –≤–∞—Å –∏–Ω—Ç–µ—Ä–µ—Å—ã.
> 3.2 –¥–Ω—è           
–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤—å—Ç–µ –º–Ω–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≤–∞—à–µ–π –ø–ª–∞–Ω–∏—Ä—É–µ–º–æ–π –ø–æ–µ–∑–¥–∫–µ –≤ –ö–∞–ª–∏–Ω–∏–Ω–≥—Ä–∞–¥—Å–∫—É—é –æ–±–ª–∞—Å—Ç—å. –ú–Ω–µ –Ω—É–∂–Ω–æ –∑–Ω–∞—Ç—å, –∫–∞–∫–∏–º —Å–ø–æ—Å–æ–±–æ–º –±—É–¥–µ—Ç–µ –ø–µ—Ä–µ–¥–≤–∏–≥–∞—Ç—å—Å—è –ø–æ –æ–±–ª–∞—Å—Ç–∏ –∏ –∫–∞–∫–∏–µ —É –≤–∞—Å –∏–Ω—Ç–µ—Ä–µ—Å—ã.
> 4  –¥–Ω—è 
–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤—å—Ç–µ –º–Ω–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≤–∞—à–µ–º —Å–ø–æ—Å–æ–±–µ –ø–µ—Ä–µ–¥–≤–∏–∂–µ–Ω–∏—è –ø–æ –æ–±–ª–∞—Å—Ç–∏ –∏ –≤–∞—à–∏—Ö –∏–Ω—Ç–µ—Ä–µ—Å–∞—Ö.
> —è –ø–µ—Ä–µ–¥–≤–∏–≥–∞—é—Å—å –ø—Ä–∏ –ø–æ–º–æ—â–∏ –±–æ–∂—å–µ–π —Å–∏–ª—ã 
–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤—å—Ç–µ –º–Ω–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≤–∞—à–∏—Ö –∏–Ω—Ç–µ—Ä–µ—Å–∞—Ö.
> —è –∏–Ω—Ç–µ—Ä–∏—Å—É—é—Å—å —Ñ—É—Ç–±–æ–ª–æ–º
chat next (4,  [–ü–ï–†–ï–î–í–ò–ñ–ï–ù–ò–ï_1], [–ò–ù–¢–ï–†–ï–°_1])

‚ûú  v0 python main.py
> —è –Ω–µ –ø–æ–µ–¥—É –≤ –ö–∞–ª–∏–Ω–∏–Ω–≥—Ä–∞–¥ 
chat next ()
> —è –ø–æ–µ–¥—É –≤ –ö–õ–î 

‚ûú  v0 python main.py 
> –Ø –æ—Ç–ø—Ä–∞–≤–ª—é—Å—å –≤ –ö–õ–î
–ö–æ–≥–¥–∞ –≤—ã –ø–ª–∞–Ω–∏—Ä—É–µ—Ç–µ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å—Å—è –≤ –ö–∞–ª–∏–Ω–∏–Ω–≥—Ä–∞–¥—Å–∫—É—é –æ–±–ª–∞—Å—Ç—å?
> 23 –∞–≤–≥—É—Å—Ç–∞ 
–°–∫–æ–ª—å–∫–æ –¥–Ω–µ–π –≤—ã –ø–ª–∞–Ω–∏—Ä—É–µ—Ç–µ –ø—Ä–æ–≤–µ—Å—Ç–∏ –≤ –ö–∞–ª–∏–Ω–∏–Ω–≥—Ä–∞–¥—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏?
> 5 —á–∞—Å–æ–≤   
–ö–∞–∫–∏–º —Å–ø–æ—Å–æ–±–æ–º –≤—ã –ø–ª–∞–Ω–∏—Ä—É–µ—Ç–µ –ø–µ—Ä–µ–¥–≤–∏–≥–∞—Ç—å—Å—è –ø–æ –ö–∞–ª–∏–Ω–∏–Ω–≥—Ä–∞–¥—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏?
> —Å–∞–º–æ–ª—ë—Ç–æ–º
–ö–∞–∫–∏–µ —É –≤–∞—Å –∏–Ω—Ç–µ—Ä–µ—Å—ã –≤ –ö–∞–ª–∏–Ω–∏–Ω–≥—Ä–∞–¥—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏?
> –æ–±—ã—á–Ω—ã–µ 
chat next (5, [], [])

‚ûú  v0 python main.py
> —è –ø–æ–µ–¥—É –Ω–∞ –ø–æ–ª–æ–≤–∏–Ω—É –¥–µ—Å—è—Ç–∏ –¥–µ—Å—è—Ç–∫–æ–≤ –¥–Ω–µ–π 
chat next (5, [], [])

‚ûú  v0 python main.py
> —è —Ö–æ—á—É –ø–æ–µ—Ö–∞—Ç—å –≤ –ö–º—Ç–∞–π –Ω–∞ –Ω–µ–¥–µ–ª—é –ø–æ–¥—Å–∫–∞–∂–∏ –º—É–∑–µ–∏ 
chat next (7, [–∞–≤—Ç–æ–±—É—Å, –ø–µ—à–∞—è –ø—Ä–æ–≥—É–ª–∫–∞], [–∏—Å—Ç–æ—Ä–∏—è, –∏—Å–∫—É—Å—Å—Ç–≤–æ])

‚ûú  v0 python main.py
> 
chat next (5, ["–∞–≤—Ç–æ–±—É—Å", "–ø–µ—à–∞—è –ø—Ä–æ–≥—É–ª–∫–∞"], ["–∏—Å—Ç–æ—Ä–∏—è", "–ø—Ä–∏—Ä–æ–¥–∞", "–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞"])

‚ûú  v0 python main.py
> .
chat next (7, [–º–∞—à–∏–Ω–∞, –≤–µ–ª–æ—Å–∏–ø–µ–¥], [–∏—Å—Ç–æ—Ä–∏—è, –ø—Ä–∏—Ä–æ–¥–∞, –Ω–∞—É–∫–∞, –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞, –∏—Å–∫—É—Å—Å—Ç–≤–æ])

‚ûú  v0 python main.py
> —Ñ—É—ã–∫—Å–ø–∞–∏—Ç–ª—å–¥–±–∂—ç
chat next (3, ["–∞–≤—Ç–æ–±—É—Å", "–ø–µ—à–∞—è –ø—Ä–æ–≥—É–ª–∫–∞"], ["–∏—Å—Ç–æ—Ä–∏—è", "–ø—Ä–∏—Ä–æ–¥–∞", "–Ω–∞—É–∫–∞"])

‚ûú  v0 python main.py
> —è –Ω–µ —É–º–µ—é —Ö–æ–¥–∏—Ç—å 
–û–ø–∏—à–∏—Ç–µ, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –∫–∞–∫–∏–µ —Å–ø–æ—Å–æ–±—ã –ø–µ—Ä–µ–¥–≤–∏–∂–µ–Ω–∏—è –≤—ã –ø–ª–∞–Ω–∏—Ä—É–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ –ö–∞–ª–∏–Ω–∏–Ω–≥—Ä–∞–¥—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏?
> —è –Ω–µ —É–º–µ—é 
–ü–æ–Ω–∏–º–∞—é, —á—Ç–æ –≤—ã –Ω–µ —É–º–µ–µ—Ç–µ —Ö–æ–¥–∏—Ç—å. –ù–æ –≤—Å—ë –∂–µ, –∫–∞–∫–∏–µ —Å–ø–æ—Å–æ–±—ã –ø–µ—Ä–µ–¥–≤–∏–∂–µ–Ω–∏—è –≤—ã –ø–ª–∞–Ω–∏—Ä—É–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ –ö–∞–ª–∏–Ω–∏–Ω–≥—Ä–∞–¥—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏?
> —è –Ω–µ –º–æ–≥—É –ø–µ—Ä–µ–¥–≤–∏–≥–∞—Ç—å—Å—è 
–í—ã –º–æ–∂–µ—Ç–µ –≤—ã–±—Ä–∞—Ç—å –ª—é–±–æ–π —Å–ø–æ—Å–æ–± –ø–µ—Ä–µ–¥–≤–∏–∂–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–π –≤–∞–º —É–¥–æ–±–µ–Ω. –ï—Å–ª–∏ –≤—ã –Ω–µ –º–æ–∂–µ—Ç–µ —Ö–æ–¥–∏—Ç—å, –≤—ã –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å, –Ω–∞–ø—Ä–∏–º–µ—Ä, –º–∞—à–∏–Ω—É –∏–ª–∏ –∞–≤—Ç–æ–±—É—Å. –ö–∞–∫–æ–π —Å–ø–æ—Å–æ–± –ø–µ—Ä–µ–¥–≤–∏–∂–µ–Ω–∏—è –≤—ã –ø–ª–∞–Ω–∏—Ä—É–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å?
> —É –º–µ–Ω—è –Ω–µ—Ç –∞–≤—Ç–æ–±—É—Å–∞ 
–ï—Å–ª–∏ —É –≤–∞—Å –Ω–µ—Ç –∞–≤—Ç–æ–±—É—Å–∞, –≤—ã –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–∞—à–∏–Ω—É –∏–ª–∏ –∑–∞–∫–∞–∑–∞—Ç—å —Ç–∞–∫—Å–∏. –ö–∞–∫–æ–π —Å–ø–æ—Å–æ–± –ø–µ—Ä–µ–¥–≤–∏–∂–µ–Ω–∏—è –≤—ã –ø–ª–∞–Ω–∏—Ä—É–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å?
> —É –º–µ–Ω—è—Ç –∞–≤—Ç–æ–º–æ–±–∏–ª—è –∏–ª–∏ –¥–µ–Ω–µ–≥ 
–ï—Å–ª–∏ —É –≤–∞—Å –Ω–µ—Ç –∞–≤—Ç–æ–º–æ–±–∏–ª—è –∏–ª–∏ –¥–µ–Ω–µ–≥, –≤—ã –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω—ã–π —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç –∏–ª–∏ –ø–µ—à–∏–µ –ø—Ä–æ–≥—É–ª–∫–∏. –ö–∞–∫–æ–π —Å–ø–æ—Å–æ–± –ø–µ—Ä–µ–¥–≤–∏–∂–µ–Ω–∏—è –≤—ã –ø–ª–∞–Ω–∏—Ä—É–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å?
> –Ω–∞–ø–∏—à–∏ –∫–æ–¥ –Ω–∞ python –¥–ª—è –ø–æ–¥—Å—á—ë—Ç–∞ —Å—É–º–º—ã 1 –∏ 2 
–í–æ—Ç –∫–æ–¥ –Ω–∞ Python –¥–ª—è –ø–æ–¥—Å—á—ë—Ç–∞ —Å—É–º–º—ã 1 –∏ 2:

print(1 + 2)
```








def process_all_layers(user_id, input_queue, output_queue):


    #------------–°–ª–æ–π1

    
    promt1 = layer1.get_promt()
    history = [
        {
        "role": "system",
        "content": promt1
        },
    ]
    while True:
        user_message = input_queue.get()
        history.append({"role": "user", "content": user_message})
        data = {
            "mode": "instruction",
            "messages": history
        }
        response = api.get_simple_answer(history)
        assistant_message = response['choices'][0]["message"]['content']
        history.append({"role": "assistant", "content": assistant_message})
        if assistant_message[0:4] == "chat":
            output_queue.put("–†–∞—Å—Å—á–∏—Ç—ã–≤–∞—é –≤–∞—à–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ, —ç—Ç–æ –∑–∞–π–º—ë—Ç –ø—Ä–∏–º–µ—Ä–Ω–æ 4 –º–∏–Ω—É—Ç—ã...")
            out = assistant_message[11:-1].split(";")
            out = [x.strip().split(',') for x in out]
            out[2] = [x.strip() for x in out[2]]
            valid = layer1.validate_input(int(out[0][0]), out[1], out[2])
            if valid == True:
                break
            else:
                history = [
                    {
                    "role": "system",
                    "content": promt1
                    },
                ]
                history.append({"role": "assistant","content": valid})
        else:
            output_queue.put(assistant_message)

    #-------------–°–ª–æ–π2
    x = 0
    while True:
        if x > 10:
            print("–Ω–µ—É–¥–∞—á–∞")
            return
        print(f"–ø–æ–ø—ã—Ç–∫–∞ {x}")
        layer2 = Layer2()
        days = out[0]
        transport = out[1]
        user_tags = out[2]
        wish = out[3]
        promt2 = layer2.create_route_prompt(days, transport, user_tags, wish)
        history = [
            {
            "role": "system",
            "content": promt2
            },
        ]
        response = api.get_simple_answer(history)
        assistant_message = response['choices'][0]["message"]['content']

        try:
            data = json.loads(assistant_message)
            #output_queue.put(str(data))
            
            z = ""
            for day_info in data:
                z += (f"–î–µ–Ω—å {day_info['day']}:\n")
                for place in day_info['route']:
                    z += (f"- {place['place_name']} \n")
                z += (f"–û–±—â–µ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ: {day_info['total_distance_km']} –∫–º\n")
                z += ("\n")

            #output_queue.put(str(z))
            days = db.find_places_from_names(data)
            
            break
        except:
            x += 1
            pass

    #--------------–°–ª–æ–π3

    layer3 = Layer3()

    similar_places_by_tags = {}
    for day_data in days:
        day_number = day_data['day']
        tags = []
        for place in day_data['route']:
            place_tags = place.get('tags', [])
            tags.extend(place_tags)
        #output_queue.put(str(tags))
        try:
            if tags:
                similar_places = db.get_filtered_places(tags)
                similar_places_by_tags[f"day_{day_number}"] = similar_places
            else:
                similar_places_by_tags[f"day_{day_number}"] = []
        except Exception as e:
            output_queue.put(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–∏—Å–∫–µ –ø–æ—Ö–æ–∂–∏—Ö –º–µ—Å—Ç –¥–ª—è –¥–Ω—è {day_number}: {str(e)}")
            similar_places_by_tags[f"day_{day_number}"] = []

    character_type = "local_enthusiast"

    try:
        prompt = layer3.create_route_optimization_prompt(days, similar_places_by_tags, character_type)
        history = [{"role": "system", "content": prompt}]
        response = api.get_simple_answer(history)

        while True:
            assistant_message = response['choices'][0]["message"]['content']
            history.append({"role": "assistant", "content": assistant_message})
            
            if "chat done" in assistant_message.lower():
                output_queue.put("–ú–∞—Ä—à—Ä—É—Ç –∑–∞–≤–µ—Ä—à–µ–Ω.")
                break
            
            output_queue.put(assistant_message)
            user_input = input_queue.get()
            history.append({"role": "user", "content": user_input})
            
            response = api.get_simple_answer(history)
    except Exception as e:
        output_queue.put(f"–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞: {str(e)}")

    output_queue.put("C–ø–∞—Å–∏–±–æ!")



    import telebot
from threading import Thread
import queue
import requests
from utill.processor import Traveler

traveler = Traveler()

# –ó–∞–º–µ–Ω–∏—Ç–µ 'YOUR_BOT_TOKEN' –Ω–∞ —Ç–æ–∫–µ–Ω –≤–∞—à–µ–≥–æ –±–æ—Ç–∞
bot = telebot.TeleBot('7618181412:AAHeHPLrM5bGH-s6dB9QvUyZbncSzSWNU7c')

# –°–ª–æ–≤–∞—Ä—å –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞ –∏ –æ—á–µ—Ä–µ–¥–µ–π –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
user_processes = {}

@bot.message_handler(commands=['start'])
def handle_start_command(message):
    user_name = message.from_user.first_name
    welcome_text = f"""
        –ü—Ä–∏–≤–µ—Ç, {user_name}! üëã  –Ø —Ç–≤–æ–π AI-–≥–∏–¥ –ø–æ –ö–∞–ª–∏–Ω–∏–Ω–≥—Ä–∞–¥—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏.

        –Ø –º–æ–≥—É –ø–æ–º–æ—á—å —Ç–µ–±–µ —Å–æ—Å—Ç–∞–≤–∏—Ç—å —Ç—É—Ä –ø–æ –ö–∞–ª–∏–Ω–∏–Ω–≥—Ä–∞–¥—É –∏ –æ–±–ª–∞—Å—Ç–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–≤–æ–∏—Ö –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–π.

        –î–ª—è —Å–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è —Ç—É—Ä–∞ –Ω–∞–ø–∏—à–∏ /—Å–æ—Å—Ç–∞–≤–∏—Ç—å_—Ç—É—Ä
        –¢–∞–∫–∂–µ —Ç—ã —Ç—ã –º–æ–∂–µ—à—å –≤—ã–±—Ä–∞—Ç—å —Å–æ–±–µ—Å–µ–¥–Ω–∏–∫–∞ –∫–æ—Ç–æ—Ä—ã–π –ø–æ–º–æ–∂–µ—Ç —Å–æ—Å—Ç–∞–≤–∏—Ç—å —Ç–µ–±–µ —Ç—É—Ä –∫–æ–º–∞–Ω–¥–æ–π
        /–Ω–∞—Å—Ç—Ä–æ–π–∫–∏

        –° —ç—Ç–æ–≥–æ –º–æ–º–µ–Ω—Ç–∞ —Å —Ç–æ–±–æ–π –±—É–¥–µ—Ç –æ–±—â–∞—Ç—å—Å—è –Ω–µ–π—Ä–æ—Å–µ—Ç—å. –ï—Å–ª–∏ —Ç–µ–±—è –Ω–µ —É—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –≤–∞—Ä–∏–∞–Ω—Ç –æ—Ç–¥—ã—Ö–∞ –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –¥–µ–Ω—å, —Ç–æ –æ—Ç–≤–µ—Ç—å –Ω–∞ —ç—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å–ª–æ–≤–æ–º ‚Äú–∏–∑–º–µ–Ω–∏‚Äù. –ö–æ–≥–¥–∞ —Ç–µ–±—è —É—Å—Ç—Ä–æ–∏—Ç —Å–¥–µ–ª–∞–Ω–Ω—ã–π —Ç—É—Ä –∏–ª–∏ —Ç—ã –∑–∞—Ö–æ—á–µ—à—å –ø—Ä–µ–∫—Ä–∞—Ç–∏—Ç—å –æ–±—â–µ–Ω–∏–µ —Å –±–æ—Ç–æ–º, –Ω–∞–ø–∏—à–∏ ‚Äú–∫–æ–Ω–µ—Ü‚Äù.

        –†–∞—Å—Å–∫–∞–∂–∏, –Ω–∞ —Å–∫–æ–ª—å–∫–æ –¥–Ω–µ–π —Ç—ã –ø–ª–∞–Ω–∏—Ä—É–µ—à—å –ø—Ä–∏–µ—Ö–∞—Ç—å –≤ –Ω–∞—à –∑–∞–º–µ—á–∞—Ç–µ–ª—å–Ω—ã–π –∫—Ä–∞–π, –∏ –∫–∞–∫–∏–µ –º–µ—Å—Ç–∞ —Ç–µ–±—è –∏–Ω—Ç–µ—Ä–µ—Å—É—é—Ç? 
        –ß–µ–º –±–æ–ª—å—à–µ —Ç—ã —Ä–∞—Å—Å–∫–∞–∂–µ—à—å –æ —Å–≤–æ–∏—Ö –∏–Ω—Ç–µ—Ä–µ—Å–∞—Ö, —Ç–µ–º —Ç–æ—á–Ω–µ–µ —è —Å–º–æ–≥—É –ø–æ–¥–æ–±—Ä–∞—Ç—å –¥–ª—è —Ç–µ–±—è –º–∞—Ä—à—Ä—É—Ç –∏ –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–µ –º–µ—Å—Ç–∞ –¥–ª—è –ø–æ—Å–µ—â–µ–Ω–∏—è!

    """
    
    try:
        photo = open('prev.jpg', 'rb')
        bot.send_photo(message.chat.id, photo, caption=welcome_text)
    except Exception as e:
        print(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è: {str(e)}")
        bot.send_message(message.chat.id, "–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è.")


@bot.message_handler(commands=['neuro'])
def handle_neuro_command(message):
    user_id = message.from_user.id
    
    # –ï—Å–ª–∏ –ø—Ä–æ—Ü–µ—Å—Å —É–∂–µ –∑–∞–ø—É—â–µ–Ω, –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –µ–≥–æ
    if user_id in user_processes:
        user_processes[user_id]['active'] = False
        #bot.reply_to(message, "–ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –Ω–µ–π—Ä–æ—Å–µ—Ç–∏...")
    
    # –°–æ–∑–¥–∞–µ–º –æ—á–µ—Ä–µ–¥–∏ –¥–ª—è –æ–±–º–µ–Ω–∞ –¥–∞–Ω–Ω—ã–º–∏ –º–µ–∂–¥—É –±–æ—Ç–æ–º –∏ –ø—Ä–æ—Ü–µ—Å—Å–æ–º
    input_queue = queue.Queue()
    output_queue = queue.Queue()
    
    # –°–æ–∑–¥–∞–µ–º –æ—Ç–¥–µ–ª—å–Ω—ã–π –ø–æ—Ç–æ–∫ –¥–ª—è –ø—Ä–æ—Ü–µ—Å—Å–∞
    def run_process():
        try:
            traveler.process_all_layers(user_id, input_queue, output_queue)
        except Exception as e:
            bot.send_message(user_id, f"–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞: {str(e)}")
        finally:
            if user_id in user_processes:
                del user_processes[user_id]

    # –°–æ–∑–¥–∞–µ–º –∏ –∑–∞–ø—É—Å–∫–∞–µ–º –Ω–æ–≤—ã–π –ø–æ—Ç–æ–∫
    process_thread = Thread(target=run_process)
    process_thread.start()
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø—Ä–æ—Ü–µ—Å—Å–µ
    user_processes[user_id] = {
        'thread': process_thread,
        'input_queue': input_queue,
        'output_queue': output_queue,
        'active': True
    }
    
    #bot.reply_to(message, "–° —ç—Ç–æ–≥–æ –º–æ–º–µ–Ω—Ç–∞ –≤—ã –æ–±—â–∞–µ—Ç–µ—Å—å —Å –Ω–µ–π—Ä–æ—Å–µ—Ç—å—é!")

    # –ó–∞–ø—É—Å–∫–∞–µ–º –æ–±—Ä–∞–±–æ—Ç–∫—É –≤—ã–≤–æ–¥–∞ –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –ø–æ—Ç–æ–∫–µ
    Thread(target=handle_output, args=(user_id,)).start()
    user_id = message.from_user.id
    if user_id in user_processes and user_processes[user_id]['active']:
        user_processes[user_id]['input_queue'].put("–ü—Ä–∏–≤–µ—Ç")
    else:
        bot.reply_to(message, "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ /neuro –¥–ª—è —Å–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è, –∏–ª–∏ /settings –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–µ–∫")

def handle_output(user_id):
    while user_id in user_processes and user_processes[user_id]['active']:
        try:
            output = user_processes[user_id]['output_queue'].get(timeout=1)
            bot.send_message(user_id, output)
        except queue.Empty:
            pass

@bot.message_handler(func=lambda message: True)
def handle_all_messages(message):
    user_id = message.from_user.id
    if user_id in user_processes and user_processes[user_id]['active']:
        user_processes[user_id]['input_queue'].put(message.text)
    else:
        bot.reply_to(message, "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ /neuro –¥–ª—è —Å–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è, –∏–ª–∏ /settings –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–µ–∫")


def run_bot():
    while True:
        try:
            bot.polling(none_stop=True)
        except Exception as e:
            print(f"–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ –±–æ—Ç–∞: {str(e)}")
            print("–ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –±–æ—Ç–∞ —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥...")
            time.sleep(3)

if __name__ == '__main__':
    run_bot()